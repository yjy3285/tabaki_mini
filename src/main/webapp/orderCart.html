<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/sandstone/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
	<meta charset="UTF-8">
	<title>Insert title here</title>
	<style>
		body, h1, h2, h3, h4, h5, h6, table, pre, xmp, plaintext, listing, input, textarea, select, a {
			font-family: 'Pretendard-Regular', 'Noto Sans KR', sans-serif;
		}

		#contentWrapper {
			width: 1200px;
			padding: 40px 0; /* header와 contentWrapper 사이의 간격 조정 */
			position: relative;
			margin-right: auto;
		    margin-left: auto;
			border-top: 1px solid #e7e8e9;
			min-height: calc(100vh - 579px);
		}

		#page_top {
			text-align: center;
			margin-bottom: 30px;
			color: white;
			-webkit-text-stroke: 1px #c85855;
			/* 글자 크기 크게 설정 */
			font-size: 2.5em; /* 글자 크기 크게 조정 */
			 /* 굵은 글씨 */
		}

		#cartWrap {
			background-color: #F8F5F0;
			padding: 40px; /* 상하 여백을 2배로 늘림 */
			border-radius: 8px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		tfoot td {
		    margin-top: 20px; /* 위 여백 추가 */
		    margin-bottom: 20px; /* 아래 여백 추가 */
		}


		.table-light {
			margin-right: auto;
		    margin-left: auto;
		}

		.basket_totalprice {
			display: flex;
			align-items: center;
			margin-bottom: 40px; /* 상하 여백을 2배로 늘림 */
			border: #DDDDDD DASHED 1PX;
		}

		.totalprice_img img {
			width: 50px;
			height: 50px;
			margin-right: 20px; /* 여백을 2배로 늘림 */
		}

		.totalprice_txt strong {
			font-size: 1.5em;
			color: #c85855;
		}

		.cartNotice .dot_list {
			list-style-type: disc;
			padding-left: 40px; /* 여백을 2배로 늘림 */
			color: #8E8C84;
		}

		#cartTable {
			width: 100%;
			text-align: center;
		}

		table {
			width: 100%;
			margin: 0 auto;
		}

		.tb_center {
			height: 40px; /* 높이를 4배로 증가 */
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.btns_order {
			text-align: center;
			margin-top: 40px; /* 상하 여백을 2배로 늘림 */
		}

		.btns_order button {
			margin: 0 10px; /* 버튼 사이 간격 조정 */
		}
		
	</style>
</head>
<body>
	<!-- 헤더자리 -->

	<!-- 장바구니 -->
	<div id="contentWrapper">
		<div id="contentWrap">
			<div id="content">
				<!-- 장바구니 타이틀 -->
				<h1 id="page_top">장바구니</h1>
				
				<!-- 장바구니 카드 -->
				<div id="cartWrap">

					<!-- 장바구니 테이블 -->
					<div id="cartTable">
						<table>
							<colgroup>
								<col width="5%">
								<col width="25%">
								<col width="30%">
								<col width="15%">
								<col width="15%">
							</colgroup>
							<thead>
								<tr class="table-light">
									<th scope="row">
										<div class="tb_center">
											<input type="checkbox" name="__allcheck" onclick="all_basket_check(this, 1);" class="MS_input_checkbox" checked="">
										</div>
									</th>
									<th scope="row">
										<div class="tb_center">사진</div>
									</th>
									<th scope="row">
										<div class="tb_center">상품명</div>
									</th>
									<th scope="row">
										<div class="tb_center">수량</div>
									</th>
									<th scope="row">
										<div class="tb_center">결제예정가</div>
									</th>
									<th scope="row">
										<div class="tb_center">선택</div>
									</th>
								</tr>
							</thead>
							<tfoot>
								<tr>
									<td colspan="8">
										<div>장바구니에 담긴 상품이 없습니다</div>
									</td>
								</tr>
							</tfoot>
						</table>
					
					</div>
					<!-- table-fill-prd -->
					<div class="basket_totalprice">
						<div class="totalprice_img">
							총 구매 금액
						</div>
						<div class="totalprice_txt">
							<strong></strong>
						</div>
					</div>
					<div class="cartNotice">
						<div class="flt">
							<ul class="dot_list">
								<li>장바구니의 상품별 할인가는 "미리 계산된 가격" 입니다</li>
								<li>주문서의 쿠폰변경시 실제 가격은 달라질 수 있습니다</li>
								<li>상품 한개당 최대 구매가능 개수는 99개입니다</li>
							</ul>
						</div>
					</div>
					<!-- 주문버튼 -->
					<div class="btns_order">
						<button type="button" class="btn btn-outline-secondary">선택삭제</button>
						<button type="button" class="btn btn-outline-secondary">계속 쇼핑하기</button>
						<button type="button" class="btn btn-outline-secondary">장바구니 비우기</button>
						<button type="button" class="btn btn-outline-danger">선택상품 주문하기</button>
					</div>						
				</div>
				<!-- cartWrap -->
			</div>
			<!-- page_body -->
		</div>
		<!-- contentWrap -->
	</div>
	
	
	<!-- 푸터자리 -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    
    <!-- 장바구니 내용 동적 구현 -->
    <script>
    // 장바구니 데이터를 저장하는 배열
    let cartItems = [];

    // 장바구니에 상품 추가 함수
    function addToCart(title, price, img) {
        const existingItemIndex = cartItems.findIndex(item => item.title === title);
        
        if (existingItemIndex >= 0) {
            // 이미 장바구니에 있는 상품이면 수량을 증가시킴
            cartItems[existingItemIndex].quantity += 1;
        } else {
            // 새로운 상품을 장바구니에 추가
            cartItems.push({
                title,
                price,
                img,
                quantity: 1
            });
        }

        renderCart();
    }

    // 로컬 스토리지에서 장바구니 데이터를 불러와서 렌더링
    function renderCart() {
        let cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
        const tableBody = document.querySelector('#cartTable tbody');
        tableBody.innerHTML = ''; // 기존 내용을 초기화

        cartItems.forEach((item, index) => {
            const row = document.createElement('tr');
            row.classList.add('table-light');
            row.innerHTML = `
                <td class="tb_center"><input type="checkbox" name="item_check_${index}" checked></td>
                <td class="tb_center"><img src="${item.img}" alt="${item.title}" style="width: 50px; height: 50px;"></td>
                <td class="tb_center">${item.title}</td>
                <td class="tb_center">
                    <input type="number" value="${item.quantity}" min="1" max="99" onchange="updateQuantity(${index}, this.value)" style="width: 60px; text-align: center;">
                </td>
                <td class="tb_center">${item.price}</td>
                <td class="tb_center"><button class="btn btn-danger btn-sm" onclick="removeFromCart(${index})">삭제</button></td>
            `;
            tableBody.appendChild(row);
        });

        // 장바구니 총 구매 금액 업데이트
        updateTotalPrice();
    }

    // 장바구니에서 상품 제거 함수
    function removeFromCart(index) {
        let cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
        cartItems.splice(index, 1);
        localStorage.setItem('cartItems', JSON.stringify(cartItems));
        renderCart();
    }

    // 수량 변경 함수
    function updateQuantity(index, newQuantity) {
        let cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
        cartItems[index].quantity = parseInt(newQuantity, 10);
        localStorage.setItem('cartItems', JSON.stringify(cartItems));
        renderCart();
    }

    // 장바구니 총 구매 금액을 계산하는 함수
    function updateTotalPrice() {
        let cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
        const totalPriceElement = document.querySelector('.totalprice_txt strong');
        const totalPrice = cartItems.reduce((acc, item) => {
            const price = parseInt(item.price.replace(/[^0-9]/g, ''), 10); // 가격에서 숫자만 추출
            return acc + (price * item.quantity);
        }, 0);
        totalPriceElement.textContent = `${totalPrice.toLocaleString()}원`;
    }

    // 페이지가 로드되면 장바구니를 초기화 및 렌더링
    document.addEventListener('DOMContentLoaded', function() {
        const tableBody = document.querySelector('#cartTable tbody');
        if (!tableBody) {
            const newTbody = document.createElement('tbody');
            document.querySelector('#cartTable').appendChild(newTbody);
        }
        renderCart();
    });
</script>

    
    
    
</body>
</html>
